<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë ˆì‹œí”¼ ì¶”ì²œ ì‹œìŠ¤í…œ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ìƒë‹¨ ë°°ë„ˆ -->
  <header class="top-banner">
    <img src="images/banner.jpg" alt="ë ˆì‹œí”¼ ì¶”ì²œ ë°°ë„ˆ" />
  </header>

  <!-- âœ… ì¬ë£Œ ì„ íƒ (ëŒ€ë¶„ë¥˜/ì†Œë¶„ë¥˜) -->
  <section class="section category" id="recipe-filter">
    <h2>ğŸ§‚ ì§€ê¸ˆ ìˆëŠ” ì¬ë£Œë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ìš”ë¦¬ëŠ”?</h2>
    <p>ëŒ€ë¶„ë¥˜ ì¬ë£Œë¥¼ ì„ íƒí•˜ë©´ ì„¸ë¶€ ì¬ë£Œê°€ ìë™ìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>

    <!-- ëŒ€ë¶„ë¥˜ ì¬ë£Œ -->
    <div id="main-ingredients">
      <label><input type="checkbox" value="ê³„ë€" class="single"> ê³„ë€</label>
      <label><input type="checkbox" value="ë°¥" class="single"> ë°¥</label>
      <label><input type="checkbox" value="ê¹€ì¹˜" class="single"> ê¹€ì¹˜</label>
      <label><input type="checkbox" class="main" data-group="meat"> ìœ¡ë¥˜/ê°€ê³µìœ¡</label>
      <label><input type="checkbox" class="main" data-group="veggie"> ì•¼ì±„</label>
      <label><input type="checkbox" class="main" data-group="noodle"> ë–¡/ë©´</label>
      <label><input type="checkbox" class="main" data-group="fish"> í•´ì‚°ë¬¼/ì–´ë¬µ/í†µì¡°ë¦¼ë¥˜</label>
    </div>

    <!-- ì†Œë¶„ë¥˜ ì¬ë£Œ -->
    <div id="sub-ingredients" style="margin-top: 1rem;"></div>
  </section>

  <!-- âœ… ì¶”ì²œ ë ˆì‹œí”¼ -->
  <div class="section">
    <h2>ì¶”ì²œ ë ˆì‹œí”¼</h2>
    <div class="recipe-list" id="recommendations"></div>
  </div>

  <!-- âœ… ì¥ë³´ê¸° ë¦¬ìŠ¤íŠ¸ -->
  <div class="section">
    <h2>ì¥ë³´ê¸° ë¦¬ìŠ¤íŠ¸</h2>
    <div id="shopping-list">ë ˆì‹œí”¼ë¥¼ í´ë¦­í•˜ë©´ ë¶€ì¡±í•œ ì¬ë£Œê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</div>
  </div>

  <div class="section bottom-layout">
    <!-- ì™¼ìª½ ì¹´í…Œê³ ë¦¬ ë°•ìŠ¤ -->
    <div class="category-group">
      <h3>ë ˆì‹œí”¼ ì¹´í…Œê³ ë¦¬</h3>
      <div class="menu">
        <a href="time.html">â± ì‹œê°„ë³„</a>
        <a href="method.html">ğŸ”¥ ì¡°ë¦¬ë°©ì‹ë³„</a>
        <a href="situation.html">ğŸ¯ ìƒí™©ë³„</a>
      </div>
    </div>

    <!-- ì˜¤ë¥¸ìª½ ìœ íŠœë²„ ë°•ìŠ¤ -->
    <div class="youtuber-section">
      <h3>ğŸ´ ìì·¨ìƒì—ê²Œ ë”±! ìš”ë¦¬ ìœ íŠœë²„ ì¶”ì²œ</h3>
      <div class="youtubers right">
        <a href="https://www.youtube.com/@%EC%9C%A0%EC%A7%80%EB%A7%8C" target="_blank">
          <img src="images/yoojiman.jpg" alt="ìœ ì§€ë§Œ ìœ íŠœë¸Œ" />
        </a>
        <a href="https://www.youtube.com/@%EC%9E%90%EC%B7%A8%EC%9A%94%EB%A6%AC%EC%8B%A0simplecooking" target="_blank">
          <img src="images/simplecooking.jpg" alt="ìì·¨ìš”ë¦¬ì‹  ìœ íŠœë¸Œ" />
        </a>
        <a href="https://www.youtube.com/@1mincook" target="_blank">
          <img src="images/1mincook.jpg" alt="ëšë”±ì´í˜• ìœ íŠœë¸Œ" />
        </a>
      </div>
    </div>
  </div>

  <!-- âœ… ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="js/recipes.js"></script>
  <script>
    const subIngredients = {
      meat: ["ë¼ì§€ê³ ê¸°", "ì†Œê³ ê¸°", "í–„", "ë² ì´ì»¨"],
      veggie: ["ì˜¤ì´", "ì–‘ë°°ì¶”", "ê°€ì§€", "ê°ì", "ê³ êµ¬ë§ˆ", "ì• í˜¸ë°•", "ìˆ™ì£¼", "ë²„ì„¯ë¥˜"],
      noodle: ["ë–¡", "ë©´"],
      fish: ["ì°¸ì¹˜ìº”", "ëª…ë€", "ì–´ë¬µ", "ë©¸ì¹˜", "ê¹€", "ì˜¤ì§•ì–´"]
    };

    const mainContainer = document.getElementById("main-ingredients");
    const subContainer = document.getElementById("sub-ingredients");
    const recommendations = document.getElementById("recommendations");
    const shoppingList = document.getElementById("shopping-list");

    function getSelectedIngredients() {
      const single = Array.from(mainContainer.querySelectorAll(".single:checked")).map(el => el.value);
      const subs = Array.from(subContainer.querySelectorAll("input:checked")).map(el => el.value);
      return [...single, ...subs];
    }

    function extractCoreIngredient(text) {
      return text.split(/[ 0-9]/)[0].replace(/[^ê°€-í£a-zA-Z]/g, '');
    }

    function updateRecommendations() {
      const selected = getSelectedIngredients();
      recommendations.innerHTML = "";

      const filtered = allRecipes.filter(recipe =>
        recipe.ingredients.some(item =>
          selected.some(sel => extractCoreIngredient(item).includes(sel))
        )
      );

      if (filtered.length === 0) {
        recommendations.innerHTML = "<p>ì„ íƒí•œ ì¬ë£Œë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ë ˆì‹œí”¼ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ˜¢</p>";
        return;
      }

      filtered.forEach(recipe => {
        const div = document.createElement("div");
        div.className = "recipe-item";
        div.textContent = "ğŸ½ï¸ " + recipe.name;
        div.onclick = () => showMissingIngredients(recipe, selected);
        recommendations.appendChild(div);
      });
    }

    function showMissingIngredients(recipe, selected) {
      const missing = recipe.ingredients.filter(item =>
        !selected.some(sel => extractCoreIngredient(item).includes(sel))
      );
      if (missing.length > 0) {
        shoppingList.innerHTML = `
          <h4>ì´ ìš”ë¦¬ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ë” í•„ìš”í•œ ì¬ë£ŒëŠ”:</h4>
          <ul>${missing.map(item => `<li>${item}</li>`).join('')}</ul>
        `;
      } else {
        shoppingList.innerHTML = `<p>ğŸ‘ ì´ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ëª¨ë“  ì¬ë£Œë¥¼ ê°–ì¶”ê³  ìˆì–´ìš”!</p>`;
      }
    }

    // ëŒ€ë¶„ë¥˜ ì„ íƒ ì‹œ í•˜ìœ„ ì¬ë£Œ í‘œì‹œ
    mainContainer.addEventListener("change", () => {
      subContainer.innerHTML = "";

      const selectedGroups = Array.from(mainContainer.querySelectorAll(".main:checked"))
        .map(input => input.dataset.group);

      selectedGroups.forEach(group => {
        if (subIngredients[group]) {
          const box = document.createElement("div");
          box.className = "sub-box";
          box.innerHTML = `<strong>${group.toUpperCase()}</strong><br>`;
          subIngredients[group].forEach(sub => {
            const label = document.createElement("label");
            label.innerHTML = `<input type="checkbox" value="${sub}"> ${sub}`;
            box.appendChild(label);
          });
          subContainer.appendChild(box);
        }
      });

      updateRecommendations();
    });

    subContainer.addEventListener("change", updateRecommendations);
    mainContainer.addEventListener("change", updateRecommendations);
  </script>

</body>
</html>
